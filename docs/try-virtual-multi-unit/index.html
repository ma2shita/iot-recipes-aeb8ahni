
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>【SORACOM ハンズオン】GPSマルチユニットSORACOM Edition をバーチャルで体験する</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://soracom.github.io/iot-recipes/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-66865146-33"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="try-virtual-multi-unit"
                  title="【SORACOM ハンズオン】GPSマルチユニットSORACOM Edition をバーチャルで体験する"
                  environment="web"
                  feedback-link="https://soracom.jp/products/kit/gps_multiunit/">
    
      <google-codelab-step label="GPSマルチユニットSORACOM Edition をバーチャルで体験する" duration="1">
        <p>レシピ難易度：★☆☆☆☆</p>
<p>ソラコムより販売されている GPSマルチユニットSORACOM Edition をバーチャルに体験するハンズオンです。Web 上に用意した仮想的な GPSマルチユニットSORACOM Edition  (以後、仮想マルチユニット) を操作して、SORACOM Harvest Data へのデータ格納や SORACOM Lagoon での可視化を体験します。SORACOM サービスを利用するためのアカウントは貸し出されます。</p>
<p class="image-container"><img style="width: 570.00px" src="img/9dd6fb09466d916.png"></p>
<aside class="special"><p>当資料はハンズオン参加者向けの資料となります。参加者には当ハンズオン用の貸し出しアカウント発行用のフォーム情報を別途お伝えしております。フォーム情報をお持ちでない方は、当資料の内容を実施できませんのでご承知おきください。</p>
</aside>
<h2 is-upgraded>本ハンズオンを行うのに必要な時間、費用</h2>
<p>本ハンズオンは以下の通りです。</p>
<ul>
<li>必要な時間: 30分</li>
<li>費用: 0円</li>
</ul>
<h2 is-upgraded>このコンテンツの進め方</h2>
<p>ページの内容を読み、また作業を行ったら右下の［Next］を押して次のステップへ進みます。また、［Back］を使って戻ったり、左のナビゲーションメニューでもページの移動が可能です。</p>
<p>左上の［×］を押してコンテンツを終了することができます。また、ページを開きなおすことで再開できます。ページのアドレスはブラウザの［履歴］メニューを利用してください。</p>

<aside class="warning"><p>本コンテンツは現状のままで提供され、株式会社ソラコムは、誤りがないことの保証を含め、明示であると黙示であるとを問わず、本コンテンツの記載内容につき、いかなる種類の表明も保証も行いません。</p>
<p>掲載情報の閲覧及び利用により、利用者自身、もしくは第三者が被った損害に対して、直接的、間接的を問わず、株式会社ソラコムは責任を負いかねます。</p>
<p>本コンテンツを実践する中で用意された機器、利用されたサービスについてのご質問は、それぞれの機器やサービスの提供元にお問い合わせをお願いします。機器やサービスの仕様は、本コンテンツ作成当時のものです。</p>
<p>株式会社ソラコムが提供する機器・サービスについてのご質問は、 <a href="https://soracom.jp/contact/" target="_blank">https://soracom.jp/contact/</a> をご確認の上、適切な窓口へのお問い合わせをお願いします。機器・サービスご利用前の導入相談は <a href="https://soracom.jp/contact/contactsales/" target="_blank">https://soracom.jp/contact/contactsales/</a> に、機器・サービスご利用開始後のサポートは、SORACOMユーザーコンソール内の<a href="https://soracom.zendesk.com/hc/ja/requests/" target="_blank">サポートサイトから「リクエストを送信」</a>(要ログイン)にてお問い合わせください。</p>
<p>本ドキュメントは <a href="https://github.com/googlecodelabs/tools" target="_blank">CLaaT</a> を用いて制作しています</p>
<p>Copyright (c) 2020 SORACOM, INC.</p>
</aside>



      </google-codelab-step>
    
      <google-codelab-step label="準備" duration="1">
        <p>本レシピを行うためには以下のものをご用意ください。</p>
<h2 is-upgraded>ハードウェア</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>品名</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>数量</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>価格</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>購入先</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>パソコン</p>
</td><td colspan="1" rowspan="1"><p>1</p>
</td><td colspan="1" rowspan="1"><p>―</p>
</td><td colspan="1" rowspan="1"><p>―</p>
</td><td colspan="1" rowspan="1"><ul>
<li>インターネット接続が可能でサイトへの接続が自由であること。</li>
<li>Google Chrome が利用可能な事 (デバイス体験ページは Google Chrome でのみ動作検証しています)</li>
</ul>
</td></tr>
</table>


      </google-codelab-step>
    
      <google-codelab-step label="ハンズオン情報の取得" duration="5">
        <p>運営より連携されたフォームを入力すると、ハンスオンの情報が記載されてメールが送信されます。当メールへは、以下の情報が記載されています。</p>
<ul>
<li>受付番号</li>
<li>デバイス体験ページの URL</li>
<li>SORACOM Harvest Data を確認するためのユーザー名・パスワード</li>
<li>SORACOM Lagoon で可視化するためのメールアドレス・パスワード・デバイス名</li>
</ul>
<p class="image-container"><img style="width: 601.70px" src="img/c58d706eb0d7d2cf.png"></p>
<p>これらの情報が記載されていることを確認して、デバイス体験ページの URL にアクセスします。</p>
<aside class="special"><p>当ハンズオンでは、ソラコムよりアカウントが貸し出されます。すでに SORACOM アカウントへログインしている場合は一度ログアウトするか、デバイス体験ページの URL をブラウザのシークレットウィンドウで開いてください。</p>
<h2 is-upgraded>(参考) ユーザーコンソールからのログアウト方法</h2>
<p>SORACOM ユーザーコンソールからのログアウトは、右上のメールアドレスが表示されているボタンをクリックすると現れる<strong>ログアウト</strong>を使用します。</p>
<h2 is-upgraded><img style="width: 507.00px" src="img/f42a64008cffce67.png"></h2>
<h2 is-upgraded>(参考) SORACOM Lagoon からのログアウト方法</h2>
<p>SORACOM Lagoon 空のログアウトには、左下のアイコンにマウスカーソルをかざして表示される<strong>サインアウト</strong>をクリックします。</p>
<p class="image-container"><img style="width: 587.00px" src="img/d59acf0fad31af47.png"></p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="仮想マルチユニットを操作" duration="5">
        <h2 is-upgraded>デバイス体験ページへアクセス</h2>
<p>デバイス体験ページより、データを SORACOM へ送信します。ハンズオン情報に記載されたデバイス体験ページの URL へアクセスしてください。</p>
<p class="image-container"><img style="width: 601.70px" src="img/b389883bfd75d042.png"></p>
<aside class="warning"><p>画像のようなページが表示されない場合、正しく URL へアクセスできていない可能性があります。ブラウザへコピー &amp; ペーストしている場合は URL を最後までコピーしてペーストしてください。</p>
</aside>
<h2 is-upgraded>データの送信</h2>
<p>実際の GPS マルチユニット SORACOM Edition は以下 のようなデータを SORACOM へ送信できます。当ハンズオンではデバイス体験ページより下の表で太字で記された<strong>位置・温湿度・加速度</strong>を変更して定期送信をシミュレーションできます。</p>
<table>
<tr><td colspan="1" rowspan="1"><p>Key</p>
</td><td colspan="1" rowspan="1"><p>範囲</p>
</td><td colspan="1" rowspan="1"><p>説明</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><strong>lat</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>-90 ~ 90</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>緯度 (度)</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><strong>lon</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>-180 ~ 180</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>経度 (度)</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>bat</p>
</td><td colspan="1" rowspan="1"><p>-1, 1 ~ 3</p>
</td><td colspan="1" rowspan="1"><p>電池ピクト(3段階、-1 は充電中)</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>rs</p>
</td><td colspan="1" rowspan="1"><p>-1 ~ 4</p>
</td><td colspan="1" rowspan="1"><p>アンテナピクト (-1は圏外)</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><strong>temp</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>-20 ~ 60</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>温度 (℃)</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><strong>humi</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>0 ~ 100</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>湿度 (%)</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><strong>x</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>-8128 ~ 8128</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>加速度 X (mG)</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><strong>y</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>-8128 ~ 8128</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>加速度 Y (mG)</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><strong>z</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>-8128 ~ 8128</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>加速度 Z (mG)</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>type</p>
</td><td colspan="1" rowspan="1"><p>0 or 1 or -1</p>
</td><td colspan="1" rowspan="1"><p>0:定期送信・加速度割り込み 1:ボタン押下時の送信 -1:異常値</p>
</td></tr>
</table>
<p>まずは、SORACOM への定期送信を有効にしましょう。「データを送信する」を ON にします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/5026601330cc9893.png"></p>
<p>「データを定期送信しています」と表示されれば成功です。</p>
<p class="image-container"><img style="width: 601.70px" src="img/8dbafdc66529588c.png"></p>
<aside class="warning"><p>「認証エラーが発生しました」と表示された場合、ハンズオン情報に記載されたデバイス体験ページへアクセスしているか確認してください。なおデバイス体験ページはハンズオン終了後、一定期間が経つと有効期限が切れて利用できなくなります。</p>
</aside>
<aside class="warning"><p><strong>注意<br></strong>デバイス体験ページは複数ウィンドウで開かないようにしてください。データが重複して送信され、ハンズオンが正しく実施できなくなります。</p>
</aside>
<h2 is-upgraded>送信するデータの変更</h2>
<p>「デバイスの状態を変更する」より温度・湿度、位置、加速度 (向き) を変更できます。それぞれお好きな状態へ変更してみましょう。この状態はいつでも変更でき、定期送信するデータへ反映されます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/cc6043d6fcf7894c.png"></p>
<p>仮想マルチユニットの画像が変わっていることも確認しましょう。</p>
<p class="image-container"><img style="width: 601.70px" src="img/da31eb32f32ba196.png"></p>
<p>以上で、データの送信ができました。</p>


      </google-codelab-step>
    
      <google-codelab-step label="SORACOM Harvest Data の確認" duration="5">
        <h2 is-upgraded>SORACOM Harvest Data でデータを確認</h2>
<p>データの定期送信を ON にしたら、「送信したデータを確認する」メニューより SORACOM サービスへ遷移します。まずは、SORACOM Harvest Data にて送信したデータを確認しましょう。デバイス体験ページの「SORACOM Harvest Data」をクリックすると、SORACOM ユーザコンソールが開きます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/1fd636d0c6792c37.png"></p>
<h2 is-upgraded>SORACOM ユーザコンソールへログイン</h2>
<p>ハンズオン情報に記載されたユーザー名とパスワードを入力してください。オペレーター ID に入力されている値は変更しません。</p>
<p class="image-container"><img style="width: 601.70px" src="img/4b5070235ca1e2d6.png"></p>
<aside class="warning"><p>当ハンズオンでは、ソラコムよりアカウントが貸し出されます。すでに SORACOM アカウントへログインしている場合は一度ログアウトするか、デバイス体験ページの URL をブラウザのシークレットウィンドウで開いてください。</p>
</aside>
<h2 is-upgraded>［自動更新］を ON にする</h2>
<p>ログインに成功すると、SORACOM Harvest Data の画面へ遷移します。遷移しない場合は、再度デバイス体験ページの「SORACOM Harvest Data」をクリックしてください。</p>
<p>[自動更新] を ON にすることで、デバイス体験ページから送信されたデータが随時反映されます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/d5e661b7180d377c.png"></p>
<aside class="special"><p><strong>自動更新とは？</strong></p>
<p>画面を再読み込みしなくとも新しいデータが自動的に表示されるようにする機能です。5秒毎に新しいデータを表示するようになります。この機能が OFF の場合は、表示する期間を指定して［検索］をクリックすることで期間内のデータを表示できます。</p>
</aside>
<h2 is-upgraded>送信されたデータの確認</h2>
<p>SORACOM Harvest Data では送信されたデータを簡易的に確認できます。グラフ左上のアイコンより可視化の形式を折れ線・棒グラフと変更したり、右上より表示するデータを変更してみましょう。可視化の形式が折れ線グラフ (<img style="width: 15.50px" src="img/843d062abc4b978d.png">) となっていることを確認します。また、&#34;●lat&#34; &#34;●lon&#34; など temp, humi 以外をクリックして、表示するデータを temp, humi のみとすると以下の画像のように仮想マルチユニットの温度・湿度を表示できます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/9f5f3cd0be0e7f4e.png"></p>
<p>また、可視化の形式をマップ形式 (<img style="width: 15.50px" src="img/d39c119de7de3f6.png">) とすると以下の画像のようにシミュレーションされた位置を表示できます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/3851bf1a74049830.png"></p>
<p>下へスクロールするとデータが JSON 形式で格納されていることが確認できます。[ダウンロード] &gt; [グラフ用データをダウンロード (CSV形式)] よりデータのダウンロードをしてみましょう。データが CSV 形式で取得できることがわかります。<img style="width: 601.70px" src="img/bf4c313511f33da4.png"></p>
<p>以上で簡単なデータの確認が出来ました。デバイス体験ページより仮想マルチユニットの状態を変更して、SORACOM Harvest Data へ格納されてデータが変化することを確認してください。</p>
<aside class="special"><p>(参考) 実際のユースケースでは API を用いて SORACOM Harvest Data へ格納したデータをダウンロードすることもあります。IoT デバイスから簡単に利用できるデータストアとして活用いただけます。詳細は<a href="https://blog.soracom.com/ja-jp/2020/06/08/asksa-howto-use-harvest/" target="_blank">こちらのブログ</a>をご参照ください。</p>
<p>なお実際の GPS マルチユニットでは「データ」に Base64 エンコードされて保管されています。上記のブログを参考に base64 デコードしたうえで利用してください。</p>
</aside>
<aside class="special"><p>(参考) 実際の GPS マルチユニットでは UDP にて base64 デコードされたデータが送信されます。</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="SORACOM Lagoon で可視化" duration="10">
        <p>SORACOM Harvest Data へ格納したデータを、よりカスタマイズしたダッシュボードで可視化したい場合は SORACOM Lagoon を利用します。デバイス体験ページより、[SORACOM Lagoon] をクリックして SORACOM Lagoon のログインページへ遷移しましょう。</p>
<p class="image-container"><img style="width: 601.70px" src="img/89039b616d6033b4.png"></p>
<h2 is-upgraded>SORACOM Lagoon へログイン</h2>
<p>SORACOM Lagoon ログインページでは、ハンズオン情報に記載されたメールアドレスとパスワードを入力してください。</p>
<p class="image-container"><img style="width: 601.70px" src="img/451a6cd9cad81b43.png"></p>
<aside class="warning"><p>当ハンズオンでは、ソラコムよりアカウントが貸し出されます。すでに SORACOM Lagoon を使ったことがある場合はご自分のアカウントへログインする場合があります。その際は、ご自分のアカウントからサインアウトして再度ハンズオン情報に記載されたメールアドレスとパスワードでログインしてください。</p>
</aside>
<h2 is-upgraded>ダッシュボードの作成</h2>
<p>当ハンズオンではダッシュボードのサンプルとしてテンプレートを用意しています。用意されたテンプレートを SORACOM Lagoon へインポートし、可視化のイメージをつかんでみましょう。</p>
<h2 is-upgraded>インポートするテンプレートをコピー</h2>
<p>再度デバイス体験ページへ移動し、[送信したデータを確認する] &gt; [SORACOM Lagoon ダッシュボードのテンプレート] &gt; [クリップボードへコピーする] をクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/281e5c1bf768c9c8.png"></p>
<h2 is-upgraded>SORACOM Lagoon へインポート</h2>
<p>左上の + アイコンにマウスカーソルをかざし、[インポート] をクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/594c5e482771d18d.png"></p>
<p>[Or paste JSON] (JSON を貼り付ける) の欄へ、先ほどコピーしたテンプレートをペーストします (Windows の場合 Ctrl + V、Mac の場合 Command + V)。その後、[Load] をクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/30883b1024746166.png"></p>
<p>確認画面が表示されるので、[Import] をクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/19679c144b188ab9.png"></p>
<p>以下のようにダッシュボードが表示されたらインポート成功です。GPS マルチユニットから得られた各データを文字やグラフ、地図や表で可視化しています。</p>
<p class="image-container"><img style="width: 601.70px" src="img/955188cbdb91393c.png"></p>
<p>体験ページより仮想マルチユニットの状態を変更し、SORACOM Lagoon 上でどのように可視化されるかを体験してください。ダッシュボードへの反映には 1 ～ 2 分かかります。</p>
<aside class="warning"><p>当ハンズオンでは、<strong>位置・温湿度・加速度</strong>のみ変更できます。電波強度やバッテリー残量は仮想マルチユニットでは固定となっています。実際の GPS マルチユニット SORACOM Edition では状況に応じた電波強度やバッテリー残量が送信されます。</p>
</aside>
<aside class="special"><p><strong>データが表示されていない？</strong></p>
<p>当サンプルダッシュボードでは過去 15 分間のデータを可視化しています。何もデータが表示されていない場合は、もう一度体験ページよりデータを送信してください。ダッシュボードへの反映には 1～2 分かかります。</p>
<p>または、右上の時計アイコンをクリックし、表示する時間の範囲を変更してみましょう。</p>
<p class="image-container"><img style="width: 587.00px" src="img/93b0d4883e5c1a62.png"></p>
</aside>
<h2 is-upgraded>(応用) ダッシュボードのカスタマイズ</h2>
<p>当ハンズオンでは、SORACOM Lagoon のイメージをすぐにつかんでいただくためにサンプルのダッシュボードを用意しました。もしさらに詳しく SORACOM Lagoon を試したい場合は、「パネルの作成」や「アラートの作成」を参照してダッシュボードをカスタマイズしてみましょう。ここまででハンズオンを終了とする場合は、「後片付けと注意事項」に進んでください。</p>


      </google-codelab-step>
    
      <google-codelab-step label="(応用) パネルの作成" duration="0">
        <p>SORACOM Lagoon ではよりカスタマイズした可視化ができます。ここでは温度を可視化するグラフパネルを作成します。右上の [パネルを追加] アイコンをクリックし、[Graph] を選択します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/4675a593042eb723.png"></p>
<p>Panel Title 右側の▼アイコンをクリックし、[編集] を選択するとパネルを編集できます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/a973808f6a88792c.png"></p>
<aside class="special"><p><strong>一度閉じたダッシュボードを再度開くには</strong></p>
<p>SORACOM Lagoon を表示していたブラウザやタブを閉じてしまった場合、再度デバイス体験ページの「SORACOM Lagoon」より開きます。次に、 ダッシュボードアイコン<img style="width: 35.15px" src="img/fa2f0cbf5b4ff6f7.png">にカーソルを乗せると表示される「管理」メニューから表示されたダッシュボードをクリックすれば、保存されたダッシュボードを再度開けます。</p>
<p class="image-container"><img style="width: 587.00px" src="img/df518ee1aefad768.png"></p>
</aside>
<h2 is-upgraded>デバイスの選択</h2>
<p>メトリックタブより、ハンズオン情報に記載のある &#34;device-&#34; から始まるデバイス名を選択し、右のドロップダウンからは &#34;temp&#34; を選択します。これにより、デバイス体験ページから送信した温度を可視化できます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/df06bdd667a64b6b.png"></p>
<aside class="special"><p><strong>データが表示されていない？</strong></p>
<p>データを蓄積し始めてから間もない場合、グラフの右端に「少しだけ」表示されている場合があります。これは、パネルの表示時間の標準が「過去6時間分」を表示するようになっているからです。</p>
<p class="image-container"><img style="width: 601.70px" src="img/c64ecf6711bfd65a.png"></p>
<p>右上の「時間」ボタンで表示範囲を設定可能です。まずは「過去15分間」くらいが良いでしょう。</p>
<p class="image-container"><img style="width: 587.00px" src="img/76a64d941a095f3.png"></p>
<p>また、グラフ作成直後のパネルは折れ線グラフ設定となっています。そのため、データを一件しか送っていない場合は「ポイント」としてのみ表示されているため、見落としがちです。何件か送るようにしてください。</p>
<p class="image-container"><img style="width: 559.00px" src="img/7444147bfe1fcff3.png"></p>
<p>それでもデータが表示されていない場合は、いったん SORACOM Harvest Data データの蓄積具合を確認するようにしてください。</p>
</aside>
<h2 is-upgraded>折れ線グラフで可視化する</h2>
<p>[表示]タブより、描画モードに「点」を追加して見やすくします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/bf57ae6ca8f357a.png"></p>
<h2 is-upgraded>タイトルの設定</h2>
<p>[全般] タブよりタイトルを指定します。</p>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>タイトル</p>
</td><td colspan="1" rowspan="1"><p><code>デバイスの温度</code></p>
</td><td colspan="1" rowspan="1"><p>任意の名前が利用できます。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 601.70px" src="img/c9f4aebbbc045f08.png"></p>
<h2 is-upgraded>ダッシュボードの保存</h2>
<p>右上の保存ボタン<img style="width: 33.00px" src="img/6780dfe4cd33f2a0.png">をクリックし、表示されたダイアログでダッシュボード名を入力した上で［保存］をクリックします。</p>
<p>ダッシュボードの更新時は名前を変更内容を記載 (任意) し、保存してください。</p>
<p class="image-container"><img style="width: 513.00px" src="img/45df3cebab9c6e45.png"></p>
<p>新規にダッシュボードを保存する場合はダッシュボード名を設定します。</p>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>名前</p>
</td><td colspan="1" rowspan="1"><p><code>仮想マルチユニットハンズオン</code></p>
</td><td colspan="1" rowspan="1"><p>任意の名前が利用できます。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 513.00px" src="img/9149c6eed1f142f8.png"></p>
<p>これでパネルの作成が出来ました。グラフパネルではほかにも様々なオプションを用意しており、さらにグラフパネル以外にも豊富な種類のパネルを用意されていますので、ぜひ活用してみて下さい。</p>
<p>(参考ドキュメント : <a href="https://dev.soracom.io/jp/start/lagoon-panel/" target="_blank">SORACOM Lagoon を利用して様々なパネルを作成する</a>)</p>
<p>また、作成したダッシュボードをエクスポートしたい場合は、以下のドキュメントをご参照ください。エクスポートダッシュボードの <code>&#34;target&#34;: &#34;d-xxxxxxxxxx&#34;</code> (<code>xxxxxxxxx</code> 部分はランダムな文字列) の <code>&#34;d-xxxxxxxxxx&#34;</code> をインポート先の環境と合わせることで本ハンズオンと同様にインポートできます。</p>
<p>(参考ドキュメント : <a href="https://dev.soracom.io/jp/start/lagoon-copy-panel/" target="_blank">SORACOM Lagoon の パネルやダッシュボードを複製する</a>)</p>


      </google-codelab-step>
    
      <google-codelab-step label="(応用) アラートの作成" duration="0">
        <p>SORACOM Lagoon のグラフパネルでは条件に応じてアラートを発報できます。発報したアラートの通知先としてメールや Slack などが設定できます。ここではメールでのアラートを作成しましょう。</p>
<h2 is-upgraded>通知チャンネルの設定</h2>
<p>アラート作成アイコン<img style="width: 42.00px" src="img/b32a9a5b5951b49c.png">にカーソルを乗せると表示される「作成」メニューから［通知チャンネル］をクリックし、その後表示される［チャンネルを追加］をクリックします。</p>
<p class="image-container"><img style="width: 297.00px" src="img/af117aa0b9d789c5.png"></p>
<h2 is-upgraded><img style="width: 292.00px" src="img/99d2dc13bedafcf6.png"></h2>
<h2 is-upgraded>通知のテスト</h2>
<p>「新しい通知チャンネルを追加」では、以下のように設定します。</p>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>名前</p>
</td><td colspan="1" rowspan="1"><p><code>温度超過の通知</code></p>
</td><td colspan="1" rowspan="1"><p>任意の名前が利用できます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>タイプ</p>
</td><td colspan="1" rowspan="1"><p>Email</p>
</td><td colspan="1" rowspan="1"><p>Email となっていれば次に進みます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Email addresses</p>
</td><td colspan="1" rowspan="1"><p>（通知の送信先 Email アドレス）</p>
</td><td colspan="1" rowspan="1"><p>通知の送信先アドレスを指定します。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 442.00px" src="img/c6fe2f32721dc34c.png"></p>
<p>ここまで入力が終わったら［送信テスト］をクリックします。「Email addresses」に記載したアドレスへ、以下のようなメールが届いていることを確認します。</p>
<p class="image-container"><img style="width: 601.70px" src="img/7534041c996f1ba0.png"></p>
<p>テストの結果が良好であれば、SORACOM Lagoon の画面に戻り［保存］をクリックします。</p>
<p class="image-container"><img style="width: 442.00px" src="img/2f663057778e0c88.png"></p>
<h2 is-upgraded>アラートの設定</h2>
<p>作成したダッシュボードを開きます。ダッシュボードアイコン<img style="width: 35.15px" src="img/fa2f0cbf5b4ff6f7.png">にカーソルを乗せると表示される「管理」メニューから表示されたダッシュボードをクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/a0de05c35a829477.png"></p>
<p class="image-container"><img style="width: 601.70px" src="img/426cc3f867268c10.png"></p>
<p>「(応用) パネルの作成」で作成したグラフパネルに対して &#34;Panel Title&#34; &gt;［編集］をクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/1b0aadbbf576fc79.png"></p>
<h2 is-upgraded>アラート条件の設定</h2>
<p>&#34;アラート&#34; タブをクリックした後、［アラートの作成］をクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/2e64af541ff9ae09.png"></p>
<p>「アラート設定」を以下の通りに設定します。</p>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>名前</p>
</td><td colspan="1" rowspan="1"><p><code>温度超過 Alert</code></p>
</td><td colspan="1" rowspan="1"><p>任意の名前が利用できます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>評価間隔</p>
</td><td colspan="1" rowspan="1"><p><code>60s</code></p>
</td><td colspan="1" rowspan="1"><p>閾値の監視間隔です。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>条件 (WHEN)</p>
</td><td colspan="1" rowspan="1"><p><code>max()</code></p>
</td><td colspan="1" rowspan="1"><p>&#34;avg()&#34; をクリックすると一覧に現れます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>条件 (OF)</p>
</td><td colspan="1" rowspan="1"><p><code>query(A, 3m, now)</code></p>
</td><td colspan="1" rowspan="1"><p>&#34;5m&#34; をクリックすると一覧が現れますが、<br>キーボードから &#34;<code>3m</code>&#34; と入力したあと<br>Enter キーを押して設定できます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>条件 (IS ABOVE)</p>
</td><td colspan="1" rowspan="1"><p><code>25</code></p>
</td><td colspan="1" rowspan="1"><p>&#34;IS ABOVE&#34; はそれ自体の条件の &#34;IS BELOW&#34;<br>(=未満)等に変更することができます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>データが無いか全ての値が Null の時</p>
</td><td colspan="1" rowspan="1"><p><code>Keep Last State</code></p>
</td><td colspan="1" rowspan="1"><p>評価間隔内でデータが無い、即ちボタンの動作が<br>無かった場合の扱いを設定しています。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>実行エラーまたはタイムアウトの時</p>
</td><td colspan="1" rowspan="1"><p><code>Keep Last State</code></p>
</td><td colspan="1" rowspan="1"><p>何らかの理由で評価に失敗した時の設定です。<br>最後の状態を維持する設定としています。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 601.70px" src="img/5e6a6f80cc490cf7.png"></p>
<aside class="special"><p><strong>設定内容の意味は？</strong></p>
<ul>
<li><code>max()</code> は、条件(OF) で設定した期間内の最大(=最高)の値です。</li>
<li><code>query(A, 3m, now)</code> は、「メトリックの &#34;A&#34; を対象に、過去 3m から now までの間」となります。</li>
</ul>
<p>合わせると、メトリック &#34;A&#34; すなわち 仮想マルチユニット の temp (温度) を対象に、過去 <code>3m</code>(分) から <code>now</code>(現在) における最大の値が <code>25</code> 以上（の時はアラート発生）という意味になります。</p>
</aside>
<p>ここまで入力が完了できたら［ルールを確認］をクリックします。この時点でデバイス体験ページの [温度・湿度] が [室温で管理する] になっていれば <code>firing: false</code> 即ち、アラートは発生せず、正常な状態となります。</p>
<p class="image-container"><img style="width: 268.00px" src="img/912d9bf6fb0c3838.png"></p>
<p>次に、デバイス体験ページから [温度・湿度] を [手で温める] に選択してデータの定期送信を ON にします。<img style="width: 601.70px" src="img/85cbd9c4255607bb.png"></p>
<p>30秒～60秒経過した後に、再度［ルールを確認］をクリックすると <code>firing: true</code> 即ち、アラートが発生した状態となります。（この時点では通知の送信先を設定していないため、アラート発生の有無を確認するのみとなります。）</p>
<p class="image-container"><img style="width: 266.00px" src="img/47407b00b4337b96.png"></p>
<p>そこからデバイス体験ページの [温度・湿度] を [室温で管理する] に変更し、約3分経過した後に、再度［ルールを確認］をクリックすると <code>firing: false</code> に戻ることが確認できるでしょう。</p>
<p>［ルールを確認］ボタンは何度でも押すことが可能ですので、何度か試してみることをお勧めいたします。</p>
<aside class="special"><p><strong>アラート発生のタイミングを調整するためには？</strong></p>
<p>評価間隔や条件の関係性は<a href="https://soracom.zendesk.com/hc/ja/articles/360028531812" target="_blank">SORACOM Lagoon のアラートがトリガーされないことがある</a>をご覧ください。</p>
</aside>
<h2 is-upgraded>通知の設定</h2>
<p>［通知］をクリックした後、 &#34;送り先&#34; の追加 <img style="width: 40.00px" src="img/8366db64ed0d3c95.png"> をクリックします。一覧の中から通知チャンネルで作成した通知先をクリックします。</p>
<p>本レシピでは &#34;温度超過の通知&#34; という名称で作ったので、それをクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/fe947371c31742b7.png"></p>
<h2 is-upgraded>メッセージの設定</h2>
<p>&#34;メッセージ&#34; にアラート発生時のメッセージを入力します。今回は temp が 25 よりも大きいときにアラートを送信するため、その旨を入力しています。</p>
<p class="image-container"><img style="width: 408.00px" src="img/e579f0e83c7dff76.png"></p>
<p>設定が完了したら右上の保存ボタン<img style="width: 33.00px" src="img/6780dfe4cd33f2a0.png">をクリックし、［保存］をクリックします。</p>
<p>以上で全ての設定が終了しました。画面右上のダッシュボードに戻る<img style="width: 54.00px" src="img/2c69286f16fd7716.png">ボタンをクリックし、ダッシュボードに戻ります。</p>
<h2 is-upgraded>アラートのメールを確認する</h2>
<p>実際に通知が来るか試してみましょう。デバイス体験ページから [温度・湿度] を [手で温める] に選択してデータの定期送信を ON にすると、以下のようなメールが届きます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/61dc695197720957.png"></p>
<p>また、次に [温度・湿度] を [室温で保管する] に選択すると 3 分ほど経過してから [OK] メールが送信されます。</p>
<p class="image-container"><img style="width: 601.70px" src="img/1b2b358df80650b1.png"></p>
<p>なお、データがダッシュボードへ反映されるには 60 秒程度かかります。そのため [温度・湿度] の変更を頻繁に実施すると想定通りのアラートが送信されない可能性があります。実際に SORACOM Lagoon を利用された際にはよりダッシュボードへの反映までの時間が短くなるプランも用意しています。</p>
<p>また、継続して温度が超過していても新たな通知は来ないようになっています。これは、頻繁な通知による「通知爆弾」を避けるための仕組みです。</p>
<p>以上で、アラートの作成は終了です。</p>


      </google-codelab-step>
    
      <google-codelab-step label="後片付けと注意事項" duration="5">
        <p>当ハンズオンではアカウントを貸し出しているため、費用は発生しません。</p>
<p>なお、貸し出しアカウント、仮想デバイス、および作成した SORACOM Lagoon のダッシュボードは<strong>約 24 時間で利用できなくなります。</strong></p>
<h2 is-upgraded>(参考) ユーザーコンソールからのログアウト方法</h2>
<p>SORACOM ユーザーコンソールからのログアウトは、右上のユーザー名が表示されているボタンをクリックすると現れる<strong>ログアウト</strong>を使用します。</p>
<h2 is-upgraded><img style="width: 507.00px" src="img/f42a64008cffce67.png"></h2>
<h2 is-upgraded>(参考) SORACOM Lagoon からのログアウト方法</h2>
<p>SORACOM Lagoon 空のログアウトには、左下のアイコンにマウスカーソルをかざして表示される<strong>サインアウト</strong>をクリックします。</p>
<p class="image-container"><img style="width: 601.70px" src="img/9febb4396e40da16.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="次のステップ" duration="5">
        <p>当ハンズオンでは Web 上に用意した仮想的な GPS マルチユニット SORACOM Edition を操作して、SORACOM Harvest Data へのデータ格納や SORACOM Lagoon での可視化を体験しました。</p>
<p>GPS マルチユニット SORACOM Edition の実デバイスは、SORACOM IoT ストアよりお求めいただけます。また利用方法について具体的な手順が記載された IoT レシピの用意もありますので是非取り組んでみてください。</p>
<p>(参考) <a href="https://soracom.jp/products/kit/gps_multiunit/" target="_blank">【商品ページ】GPS マルチユニット SORACOM Edition</a></p>
<p>(参考) <a href="https://soracom.github.io/iot-recipes/air-environment-by-gps-multiunit/#0" target="_blank">【IoT DIY レシピ】GPS マルチユニット SORACOM Edition で作る「健康管理や肌の乾燥を防ぐ温湿度計」</a></p>
<p>また、今回作成したのと同様な SORACOM Lagoon ダッシュボードを実デバイスで利用する手順や、各パネルがどのように設定されているかの解説も用意してあります。</p>
<p>(参考) <a href="https://dev.soracom.io/jp/start/gps_multiunit_lagoon/" target="_blank">GPS マルチユニット SORACOM Edition と SORACOM Lagoon で高度に可視化する</a></p>
<p>今回のハンズオンでは SORACOM Harvest Data や SORACOM Lagoon の使い勝手を体験いただきましたが、実際のデバイスはさらに以下 3 つのような特長があります。</p>
<h3 is-upgraded>[1] バッテリー内蔵のシンプルなセルラーデバイス</h3>
<p>バッテリーを内蔵するため、小型で持ち運びも可能です。また、設定はクラウドからダウンロードするため、PC へドライバをインストールしてデバイスへプログラムを書き込む必要もありません。さらにセルラーデバイスのため Wi-Fi の設定が不要で屋外でも使用できるという特長があります。</p>
<h3 is-upgraded>[2] データ送信時間帯の指定や加速度割り込み機能を利用できる</h3>
<p>実際のデバイスでは、平日の日中のみデータを送信する、といったデータ送信時間帯の指定や、たとえば車載デバイスとして利用して急ブレーキがあったときにデータを送信する、といった加速度割り込み機能を利用できます。詳細は<a href="https://dev.soracom.io/jp/gps_multiunit/how-it-works/" target="_blank">ユーザードキュメント</a>を参照してください。</p>
<h3 is-upgraded>[3] SORACOM Harvest Data だけでなく、他のサービスも利用できる</h3>
<p>SORACOM Harvest Data へデータを格納するだけでなく、クラウドサービスや FaaS と連携するような SORACOM サービスも利用できます。以下のレシピでは FaaS と連携する例を紹介しています。</p>
<p>(参考) <a href="https://soracom.github.io/iot-recipes/status-changer-by-gps-multiunit/#0" target="_blank">【IoT DIY レシピ】GPS マルチユニット SORACOM Edition で作る「在席状況の自動更新デバイス」</a></p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://soracom.github.io/iot-recipes/codelab-elements/native-shim.js"></script>
  <script src="https://soracom.github.io/iot-recipes/codelab-elements/custom-elements.min.js"></script>
  <script src="https://soracom.github.io/iot-recipes/codelab-elements/prettify.js"></script>
  <script src="https://soracom.github.io/iot-recipes/codelab-elements/codelab-elements.js"></script>

</body>
</html>
