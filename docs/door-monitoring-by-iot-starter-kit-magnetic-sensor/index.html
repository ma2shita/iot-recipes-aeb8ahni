
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>【IoT DIY レシピ】IoT 体験キット ～磁気センサー～ で作る「ドアの開閉モニタリング」</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://soracom.github.io/iot-recipes/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-66865146-33"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="door-monitoring-by-iot-starter-kit-magnetic-sensor"
                  title="【IoT DIY レシピ】IoT 体験キット ～磁気センサー～ で作る「ドアの開閉モニタリング」"
                  environment="web"
                  feedback-link="https://soracom.jp/products/kit/magnetic_sensor_kit/">
    
      <google-codelab-step label="SORACOM LTE-M Button Plusでできる「ドアの開閉モニタリング」" duration="1">
        <p>レシピ難易度：★★☆☆☆</p>
<p>SORACOM LTE-M Button Plus と磁石で動くスイッチセンサー(磁気式リードスイッチ)がセットになった「IoT 体験キット ～磁気センサー～」を利用したドアのモニタリングです。SORACOM のサービスを活用してドア開閉の記録から通知までを行います。</p>
<p class="image-container"><img style="width: 602.00px" src="img/b05c2591e4d70e90.png"></p>
<p class="image-container"><img style="width: 480.00px" src="img/20b515524b4e36d0.gif"></p>
<h2 is-upgraded>本レシピを行うのに必要な時間、概算費用</h2>
<p>本レシピは以下の通りです。</p>
<ul>
<li>必要な時間: 約90分</li>
<li>概算費用: 約9500円</li>
</ul>
<p>※ 概算費用: ハードウェアや SORACOM を始めとした各種サービスの概ねの費用 (税や送料などの付帯費用や無料枠適用は考慮しないものとしています)</p>
<h2 is-upgraded>このコンテンツの進め方</h2>
<p>ページの内容を読み、また作業を行ったら右下の［Next］を押して次のステップへ進みます。また、［Back］を使って戻ったり、左のナビゲーションメニューでもページの移動が可能です。</p>
<p>左上の［×］を押してコンテンツを終了することができます。また、ページを開きなおすことで再開できます。ページのアドレスはブラウザの［履歴］メニューを利用してください。</p>

<aside class="warning"><p>本コンテンツは現状のままで提供され、株式会社ソラコムは、誤りがないことの保証を含め、明示であると黙示であるとを問わず、本コンテンツの記載内容につき、いかなる種類の表明も保証も行いません。</p>
<p>掲載情報の閲覧及び利用により、利用者自身、もしくは第三者が被った損害に対して、直接的、間接的を問わず、株式会社ソラコムは責任を負いかねます。</p>
<p>本コンテンツを実践する中で用意された機器、利用されたサービスについてのご質問は、それぞれの機器やサービスの提供元にお問い合わせをお願いします。機器やサービスの仕様は、本コンテンツ作成当時のものです。</p>
<p>株式会社ソラコムが提供する機器・サービスについてのご質問は、 <a href="https://soracom.jp/contact/" target="_blank">https://soracom.jp/contact/</a> をご確認の上、適切な窓口へのお問い合わせをお願いします。機器・サービスご利用前の導入相談は <a href="https://soracom.jp/contact/contactsales/" target="_blank">https://soracom.jp/contact/contactsales/</a> に、機器・サービスご利用開始後のサポートは、SORACOMユーザーコンソール内の<a href="https://soracom.zendesk.com/hc/ja/requests/" target="_blank">サポートサイトから「リクエストを送信」</a>(要ログイン)にてお問い合わせください。</p>
<p>本ドキュメントは <a href="https://github.com/googlecodelabs/tools" target="_blank">CLaaT</a> を用いて制作しています。</p>
<p>Copyright (c) 2020 SORACOM, INC.</p>
</aside>



      </google-codelab-step>
    
      <google-codelab-step label="準備" duration="1">
        <p>本レシピを行うためには以下のものをご用意ください。</p>
<h2 is-upgraded>ハードウェア</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>品名</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>数量</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>価格</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>購入先</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><a href="https://soracom.jp/products/kit/magnetic_sensor_kit/" target="_blank">IoT 体験キット ～ 磁気センサー</a></p>
</td><td colspan="1" rowspan="1"><p>1</p>
</td><td colspan="1" rowspan="1"><p>8,880円</p>
</td><td colspan="1" rowspan="1"><p>ソラコム</p>
</td><td colspan="1" rowspan="1"><p>キットの中には以下のものが含まれています。<br>(それぞれを個別に準備しても構いません)</p>
<ul>
<li>SORACOM LTE-M Button Plus 本体 x 1</li>
<li>磁気センサースイッチ x 1</li>
<li>接続端子 x 1</li>
</ul>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>パソコン</p>
</td><td colspan="1" rowspan="1"><p>1</p>
</td><td colspan="1" rowspan="1"><p>―</p>
</td><td colspan="1" rowspan="1"><p>―</p>
</td><td colspan="1" rowspan="1"><ul>
<li>インターネット接続が可能でサイトへの接続が自由であること。</li>
<li>Google Chrome 等の最新ブラウザーが利用可能な事。        </li>
</ul>
</td></tr>
</table>
<p>※ 金額はレシピ作成時となります。税抜き・送料別です。</p>
<h2 is-upgraded>その他必要なもの</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>必要なもの</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>費用</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>作成方法など</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>SORACOM アカウント</p>
</td><td colspan="1" rowspan="1"><p>無料※</p>
</td><td colspan="1" rowspan="1"><p><a href="https://soracom.github.io/iot-recipes/create-account-soracom-jp/" target="_blank">SORACOM アカウントの作成 (JP)</a></p>
</td></tr>
</table>
<p>※ アカウント作成・維持の費用の料金です。</p>
<h2 is-upgraded>設置に利用したもの</h2>
<p>本レシピで設置時に利用した部材です。必須ではありませんがご参考にお使いください。</p>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>品名</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>数量</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>ビニールタイ</p>
</td><td colspan="1" rowspan="1"><p>1</p>
</td><td colspan="1" rowspan="1"><p>ケーブルをまとめるのに役立ちます。<a href="https://www.amazon.co.jp/dp/B000QUD1EQ" target="_blank">約400円</a>です。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>両面テープ</p>
</td><td colspan="1" rowspan="1"><p>1</p>
</td><td colspan="1" rowspan="1"><p>磁気センサー等の固定用です。</p>
<p>設置面を傷めて怒られないように配慮できる粘着力のものをご用意ください。</p>
</td></tr>
</table>


      </google-codelab-step>
    
      <google-codelab-step label="SORACOM LTE-M Button が届いたら" duration="5">
        <p>SORACOM LTE-M Button は、 SORACOM に登録することで様々なクラウドとの連携が可能となります。そのため、まず SORACOM LTE-M Button がお手元に届いたら、SORACOM へ登録をしましょう。<br>※ すでに登録済みの場合は次へお進みください。</p>
<p>登録の方法は<a href="https://soracom.github.io/iot-recipes/register-ordering-sim-jp/" target="_blank">発注済みの SIM を登録する(JP)</a>をご覧ください。約5分で完了します。</p>
<p>登録が完了すると SORACOM LTE-M Button が SIM 管理の一覧に表示されますので、確認ください。</p>
<p class="image-container"><img style="width: 602.00px" src="img/f0af04540ce9c1c7.png"></p>
<aside class="special"><p><strong>SORACOM の便利な使い方: SIM の「名前」機能</strong></p>
<p>SIM には「名前」を付けることができ、これで整理が可能です。特に複数の SIM (ボタン含む) をお持ちの際には、名前を付けることを強くお勧めいたします。</p>
<p>名前の付け方は <a href="https://dev.soracom.io/jp/start/console/#name_tag" target="_blank">SIM への名前の付け方</a>をご覧ください。</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="グループの作成と SIM の所属させる" duration="10">
        <p>SORACOM の IoT データ収集・蓄積サービス <a href="https://soracom.jp/services/harvest/" target="_blank"><strong>SORACOM Harvest Data</strong></a> を利用して、データの可視化を簡単に実現してみましょう。</p>
<p>まずは<strong>グループ</strong>の作成と、作成したグループへ SIM を所属させる事から始めます。</p>
<aside class="special"><p><strong>SORACOM Harvest Data とは？</strong></p>
<p>IoT デバイスからのデータの収集や蓄積、およびファイルを保存するサービスが SORACOM Harvest (ソラコム ハーベスト) です。IoT デバイスからのデータの収集・蓄積対応しているのが SORACOM Harvest Data、画像ファイルやログファイルといったファイルに対応しているのが SORACOM Harvest Files となります。</p>
</aside>
<aside class="special"><p><strong>グループとは？</strong></p>
<p>SORACOM サービスのほとんどが<strong>グループ</strong>という単位に対して設定するようになっています。SORACOM Harvest Data 等、SORACOM サービスのほとんどが SIM に直接設定をするのではなくグループに設定をします。そして、SIM をグループに所属させることで SORACOM サービスが利用できるという間接的な仕組みです。<img style="width: 764.50px" src="img/59a3bc5bf39d1434.png"></p>
<p>グループを作成してから SIM を所属させる方法の他、グループの作成と SIM の所属を同時に行う方法もあります。本レシピでは後者の「同時に行う」手順で進めていきます。</p>
</aside>
<h2 is-upgraded><a href="https://console.soracom.io/" target="_blank">SORACOM ユーザーコンソール</a>にログインした後［Menu］&gt;［SIM 管理］とクリックして SIM 管理画面を開きます。</h2>
<p class="image-container"><img style="width: 566.00px" src="img/c4968675c5a9a1c8.png"></p>
<aside class="warning"><p><strong>［SIM 管理］をクリックしても画面が切り替わらない場合は？</strong></p>
<p>すでに SIM 管理画面を開いている場合は、［SIM 管理］をクリックしても画面が切り替わることがありません。その場合、青の点線で囲まれている「SORACOM ロゴ」をクリックすることでメニューを閉じることができます。</p>
</aside>
<h2 is-upgraded>SORACOM Harvest Data でデータの収集を行いたい SIM (SORACOM LTE-M Button) にチェックを付け、［操作］&gt;［所属グループ変更］とクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/f27d0ddf2224ee5f.png"></p>
<aside class="special"><p><strong>SORACOM の便利な使い方: 複数の SIM を同時に扱う</strong></p>
<p>チェックをつける対象を複数にすれば、一度の複数の SIM を対象に操作が可能です。</p>
</aside>
<h2 is-upgraded>「新しい所属グループ」のプルダウンボックスをクリックした後、［新しいグループを作成...］をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/9cf95365d7028f2c.png"></p>
<h2 is-upgraded>「グループ作成」のグループ名を入力して［グループ作成］をクリックします。</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>例</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>グループ名</p>
</td><td colspan="1" rowspan="1"><p><code>door-monitor</code></p>
</td><td colspan="1" rowspan="1"><p>自由に入力可能です。日本語も設定可能です。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 385.00px" src="img/4b3c529304b53db4.png"></p>
<h2 is-upgraded>新しい所属グループが先ほど作成したグループになっていることを確認したら［グループ変更］をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/6fdcb44201c45385.png"></p>
<h2 is-upgraded>自動的に SIM 管理画面に戻ります。<br>SIM の「グループ」に先ほど作ったグループが設定されていることを確認してください。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/fd00a7b19862ede2.png"></p>
<p>以上で、グループの作成と所属の作業は完了です。</p>


      </google-codelab-step>
    
      <google-codelab-step label="グループの設定を行う" duration="15">
        <p>グループに「<strong>バイナリ―パーサー機能</strong>」「<strong>SORACOM Harvest Data</strong>」の2つの設定を行います。</p>
<aside class="special"><p><strong>バイナリ―パーサー機能とは？</strong></p>
<p>ハードウェア開発では容量を節約するために「バイナリ形式」のデータを用いることがあります。一方、昨今のクラウドはシステム開発を容易にするために「JSON 形式」のデータを扱うことが多くあります。バイナリ―パーサー機能は、SORACOM プラットフォーム上でバイナリからJSONへ変換する仕組みです。この機能を利用することで、データ変換用のシステムやプログラムが不要となります。詳細は<a href="https://dev.soracom.io/jp/docs/binary_parser/" target="_blank">リファレンス</a>をご覧ください。</p>
</aside>
<aside class="special"><p><strong>覚えておきたい知識：簡易位置測位機能</strong></p>
<p>SORACOM LTE-M Button の通信で使用している &#34;plan-KM1&#34; というサブスクリプション(通信プラン) は、携帯電話の基地局の位置情報や電波の強さを基に、LTE 通信の通信開始時点でのおおよその位置情報を取得して SORACOM サービスと連携できる機能が利用できます。</p>
<p>今回のレシピでは利用しませんが、LTE 通信のみで利用できることから GPS 等が無くとも位置測位が可能となります。興味がある方は<a href="https://dev.soracom.io/jp/docs/location_service/" target="_blank">簡易位置測位機能の設定ガイド</a>をご覧ください。</p>
<p>※ SORACOM LTE-M Button powered by AWS は plan-KM1 を使用していますが本機能が利用できません。</p>
</aside>
<h2 is-upgraded>SIM 管理画面から、SORACOM LTE-M Button に割り当てたグループ名をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/6bb8a2ebf3552e7b.png"></p>
<h2 is-upgraded>［SORACOM Air for Cellular 設定］をクリックして設定ができるように開きます。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/28c1e31f576c8af5.png"></p>
<h2 is-upgraded>「SORACOM Air for Cellular 設定」で以下のように設定します。</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>バイナリ―パーサー設定</p>
</td><td colspan="1" rowspan="1"><p>ON</p>
</td><td colspan="1" rowspan="1"><p>スイッチはクリックすることで OFF から ON に切り替えることができます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>バイナリ―パーサー設定 / フォーマット</p>
</td><td colspan="1" rowspan="1"><p><code>@button</code></p>
</td><td colspan="1" rowspan="1"><p>半角英数で入力してください。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 509.00px" src="img/99a6bf4a706e57e2.png"></p>
<p>最後に［保存］をクリックしてください。</p>
<h2 is-upgraded>同じページの中にある［SORACOM Harvest Data 設定］をクリックして設定ができるように開きます。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/7628690cf5f7b17e.png"></p>
<h2 is-upgraded>「SORACOM Harvest Data 設定」で以下のように設定します。</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>（スイッチ）</p>
</td><td colspan="1" rowspan="1"><p>ON</p>
</td><td colspan="1" rowspan="1"><p>スイッチはクリックすることで OFF から ON に切り替えることができます。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 262.00px" src="img/b8dd4f4f9fc5f281.png"></p>
<p>最後に［保存］をクリックしてください。<br>その後表示される「SORACOM Harvest Data が有効になっています」のダイアログでは［OK］をクリックしてください。</p>
<p>以上で「バイナリ―パーサー機能」SORACOM Harvest Data」の2つの設定が完了しました。<br>すでに SORACOM LTE-M Button (の SIM)は、このグループに所属しているためこの時点から SORACOM LTE-M Button からのデータが SORACOM Harvest Data に表示されるようになります。</p>


      </google-codelab-step>
    
      <google-codelab-step label="SORACOM Harvest Data でデータを確認する" duration="10">
        <p>SORACOM LTE-M Button からのデータが SORACOM Harvest Data に表示されることを確認してみましょう。</p>
<h2 is-upgraded>［Menu］&gt;［SIM 管理］とクリックして SIM 管理画面を開きます。</h2>
<p class="image-container"><img style="width: 566.00px" src="img/c4968675c5a9a1c8.png"></p>
<h2 is-upgraded>SORACOM Harvest Data でデータの表示を行いたい SIM (SORACOM LTE-M Button) にチェックを付け、［操作］&gt;［データを確認］とクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/931abc46460b7993.png"></p>
<h2 is-upgraded>表示された画面で［自動更新］を ON にします。</h2>
<p>この表示された画面が SORACOM Harvest Data の画面となります。</p>
<aside class="special"><p><strong>自動更新とは？</strong></p>
<p>画面を再読み込みしなくとも新しいデータが自動的に表示されるようにする機能です。5秒毎に新しいデータを表示するようになります。この機能が OFF の場合は、表示する期間を指定して［検索］をクリックすることで期間内のデータを表示できます。</p>
</aside>
<p class="image-container"><img style="width: 770.29px" src="img/65102e07fb744e69.png"></p>
<h2 is-upgraded>SORACOM LTE-M Button を押してデータを確認する</h2>
<p>SORACOM LTE-M Button のデータが SORACOM Harvest Data に表示されていることが確認できます。</p>
<h3 is-upgraded>1件のデータが到着した様子</h3>
<p>※ ボタンを「長押し」したため、<code>clickType</code> の値が <code>3</code> として表示されています。</p>
<p class="image-container"><img style="width: 745.50px" src="img/4641aa400adeb567.png"></p>
<h3 is-upgraded>データテーブルを表示する</h3>
<p>データはグラフだけでは無く、ページの下の方でデータテーブルとして表示されます。ここで具体的な値を確認できます。</p>
<p class="image-container"><img style="width: 721.26px" src="img/19e1be1a682b16bc.png"></p>
<p>以上で全ての作業は終了です。</p>


      </google-codelab-step>
    
      <google-codelab-step label="SORACOM LTE-M Button Plus と磁気センサーを接続する" duration="15">
        <h2 is-upgraded>「接続端子」の使い方</h2>
<p>キットに付属の接続端子は、ハンダ付けや圧着チューブ等を利用せずともケーブル同士を簡易的に接続できる端子です。矢印の方向に結線（接続）されており、このモデルは同時に2本のケーブルをつなげることができます。</p>
<p class="image-container"><img style="width: 277.00px" src="img/ee991973770b9b31.png"></p>
<h3 is-upgraded>取り付け方</h3>
<p>端子上部を押さえると、穴の中の金属部分が押し下げられてケーブルが押し込めるようになります。上部を押しつつ、穴にケーブルの金属部分を押し込みます。その後、上部を離すと、金属の弾力でケーブルが固定されます。</p>
<p class="image-container"><img style="width: 480.00px" src="img/74f10b67cbb98e58.gif"></p>
<p>押し込める長さはおよそ 5~8mm です。取り付けた後、軽く引っ張ってみて取れなければ成功です。（強く引きすぎると抜けてしまうので注意ください。）</p>
<p>ケーブルの取り外しは、取り付けた時と同様に上部を押さえます。ゆるんだタイミングでケーブルを引き抜いてください。</p>
<aside class="warning"><p><strong>接続端子はあくまで試験時の利用に留めてください</strong></p>
<p>本格的な運用においては接続端子を用いず、ハンダ付けや圧着チューブなどで接続して安定的な結線をするのが望ましいです。</p>
</aside>
<h2 is-upgraded>「IoT 体験キット ～ 磁気センサー」に含まれている磁気センサーにについて</h2>
<p>キットに含まれている磁気センサーは「センサー部」「磁石部」という2つの部位で構成されています。</p>
<p class="image-container"><img style="width: 439.50px" src="img/a11cccf95225b824.png"></p>
<p>センサー部からは3本のケーブルが出ていますが、このケーブルの組み合わせ方でセンシング可能な内容を「離れた時に &#34;ON&#34;」もしくは「近づいた時に &#34;ON&#34;」と変更できます。</p>
<h3 is-upgraded>離れた時に &#34;ON&#34; となる組み合わせ</h3>
<p>磁気センサー部の「白」と「茶」のケーブルを SORACOM LTE-M Button と接続します。これにより、磁気センサーのセンサー部と磁石部が離れた時にセンサーが &#34;ON&#34; となります。</p>
<p class="image-container"><img style="width: 435.00px" src="img/5ab925a6dc9333a.png"></p>
<p>例えば、玄関のような「普段は閉まっているドア」に取り付けておき、「開いたら ON」に利用できます。</p>
<h3 is-upgraded>近づいた時に &#34;ON&#34; となる組み合わせ</h3>
<p>磁気センサー部の「白」と「灰」のケーブルを SORACOM LTE-M Button と接続します。これにより、磁気センサーのセンサー部と磁石部が近づいた時にセンサーが &#34;ON&#34; となります。</p>
<p class="image-container"><img style="width: 435.00px" src="img/c191066c140d742a.png"></p>
<p>例えば、店舗の入り口のような「普段は開いているドア」に取り付けておき、「閉まったら ON」に利用できます。</p>
<h3 is-upgraded>センサーの反応距離</h3>
<p>センサーの反応距離は約 2cm です。これよりこれより離れると ON 、もしくは、近づくと  ON となります。（センサーの個体差があるため、設置前に確認するようにしてください。）</p>
<p class="image-container"><img style="width: 437.00px" src="img/7380db0fff2849d5.png"></p>
<aside class="warning"><p><strong>誤動作する時がある？</strong></p>
<p>磁気センサーは、センサー部の中に磁力で ON/OFF するスイッチが入っており、それに対して磁石部の中にある永久磁石が近づく・離れることでセンサー部が ON/OFF するようになっています。センサー部は対となっている磁石部でなくとも「磁石であれば何でも反応する」ため、磁力を有しているものが近づく事でセンシングしてしまう事もあり得ます。昨今ではタブレットのフタやノートパソコンの閉じる部分に磁石が使われていますので、何らかの理由でそこに反応してしまう可能性があります。そのため、取り付け位置は誤判定を避けるような位置を検討してください。</p>
</aside>
<aside class="special"><p><strong>センシング範囲を変更したい場合は？</strong></p>
<p>磁石部には永久磁石が入っています。センサー部は対になっている磁石部である必要が無いため、この磁石部を変更することで、センシング範囲を変更可能です。例えば、ネオジム磁石のような強力なものを利用することで範囲を広げることができます。一方、センサー部が着磁(磁石化)して常に ON (もしくは常に OFF)の状態となり不良となってしまう恐れもあるので注意が必要です。</p>
</aside>
<h3 is-upgraded>接続の様子</h3>
<p>すでに SORACOM LTE-M Button Plus 側の接続が終わった接続端子に、白と茶のケーブルをつなげている様子です。</p>
<p class="image-container"><img style="width: 480.00px" src="img/d0e51009d7003359.gif"></p>
<p>接続した後は何度かテストを行ってください。</p>
<aside class="special"><p><strong>センサーから発せられるデータ (clickType) について</strong></p>
<p>センサーからのデータは <code>clickType = 3</code> 即ち「長押し」として送信されることがほとんどです。これは、センサーに近づいて（もしくは離れて）センサーが反応した状態が「ボタンを押した状態」と同じであるためです。そのため、センサー部と磁石部を短時間で近づけたり離したりすれば、<code>clickType = 1</code> (シングル押し) や <code>clickType = 2</code> (ダブル押し) としてデータ送信されます。</p>
<p>取り付ける対象にもよりますが、磁気センサーを用いた場合はあまり細かい動作制御が難しいことがほとんどですので、<code>clickType</code> の値は利用せずに「データが発生した」という事実のみを利用した方が好ましい結果が得られるでしょう。</p>
</aside>
<aside class="special"><p><strong>近づいた時と離れた時の両方をセンシングするには？</strong></p>
<p>SORACOM LTE-M Button Plus を2台使用することで、近づいた時と離れた時の両方のセンシングが可能です。（接続端子は省略しています。）</p>
<p class="image-container"><img style="width: 435.00px" src="img/ef633bcefd0c2e8e.png"></p>
<p>ポイントは白ケーブルを共有するところです。</p>
<p>また、発せられたデータがどちらのボタンから来たのか識別する方法は、ボタンに割り当てられている IMSI(加入者識別番号) が利用できます。</p>
<p>※ SORACOM LTE-M Button Plus 1台で実現したい場合は、本キットに同梱の磁気センサーでは無く、対応するセンサーに変更することで可能となります。</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="ドアに取り付ける" duration="20">
        <p>今回は横開きのドアに取り付けました。普段は閉まっていて、開いた時（＝離れた時に ON）にする組み合わせとしました。</p>
<p>SORACOM LTE-M Button Plus の側面に両面テープを貼り、柱に貼り付けてあります。壁紙が若干弱く、両面テープの剥離時に壁面を傷めてしまう恐れがあったため、このような取り付けにしています。</p>
<p>ドアが閉まった状態で近づくようにセンサー部を柱に、磁石部をドア側に貼り付けています。これらも両面テープです。</p>
<p class="image-container"><img style="width: 602.00px" src="img/ed41298d3fb873a4.png"></p>
<p>邪魔なケーブルはいったんビニールタイでまとめています。設置位置が決まったら必要な長さにカットする等しましょう。</p>
<aside class="special"><p><strong>稼働する方に磁石部を取り付けましょう</strong></p>
<p>センサー部を稼働する方に取り付けてしまうと SORACOM LTE-M Button Plus 本体も稼働する方に取り付ける必要が出てきてしまいます。稼働する方には取り付けが簡単な磁石部を付けるようにしましょう。</p>
</aside>
<h2 is-upgraded>動作の様子</h2>
<p>開いた直後に SORACOM LTE-M Button Plus の LED の点滅が開始（＝通信開始）していることがわかるかと思います。</p>
<p class="image-container"><img style="width: 480.00px" src="img/20b515524b4e36d0.gif"></p>
<p>実際に動作させてみて SORACOM Harvest Data でデータの受信状況を確認してみてください。</p>
<aside class="special"><p><strong>連続したドアの開閉の扱いは？</strong></p>
<p>SORACOM LTE-M Button Plus は乾電池で動作するように省電力化されています。それを実現するため、普段は通信部分を OFF にしており、センサーが反応したタイミングで始めて通信を開始します。（スマートフォンで例えるなら、普段は電源 OFF にしてあり、必要なときのみ ON にして立ち上がってから通信を開始するようなものです。）</p>
<p>通信開始からデータ送信終了までに約8~12秒程度かかりますが、その間に発生したデータは全て無視されるため、あまり頻度の高い開閉のセンシングには向いていません。このような頻度の高い通信を処理したい場合は <a href="https://soracom.jp/products/module/wio_lte/" target="_blank">Wio LTE JP Version</a> のようなマイコンの活用を検討します。</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="SORACOM Lagoon でダッシュボードを作成する（有効化まで）" duration="10">
        <p>設定と設置が完了したら、蓄積されたデータを SORACOM Lagoon で活用していきます。</p>
<h3 is-upgraded>SORACOM Lagoon 用語解説</h3>
<p>ここで SORACOM Lagoon で使われる用語を解説します。</p>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>用語</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>意味</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>プラン</p>
</td><td colspan="1" rowspan="1"><p>SORACOM Lagoon の契約プランです。機能と料金が異なります。<a href="https://soracom.jp/services/lagoon/price/" target="_blank">SORACOM Lagoon のご利用料金</a>に機能や料金の比較表があります。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>メトリクス</p>
<p>(メトリック)</p>
</td><td colspan="1" rowspan="1"><p>データが格納されている先です。SORACOM Lagoon では以下の4つの中から選び、その中からノード(SIMや回線)を選択します。</p>
<ul>
<li>Air = SORACOM Air for セルラー</li>
<li>LoRa = SORACOM Air for LoRaWAN</li>
<li>Sigfox = SORACOM Air for Sigfox</li>
<li>Device = SORACOM Inventory デバイス</li>
</ul>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>データソース</p>
</td><td colspan="1" rowspan="1"><p>メトリクスの参照先です。SORACOM Lagoon では &#34;Harvest&#34; (= SORACOM Harvest) を選ぶとメトリクスが展開されます。 Grafana ではテスト用のランダムデータが表示されます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>パネル</p>
</td><td colspan="1" rowspan="1"><p>パネルはデータを表示する領域です。データソースとメトリクスを指定すると、そのメトリクス(たとえばSIM)のデータをパネルで使えるようになります。</p>
<p>様々なパネルが存在します。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>ダッシュボード</p>
</td><td colspan="1" rowspan="1"><p>複数のパネルを束ねて「1枚の画面」にしたものがダッシュボードです。共有の単位となります。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>SORACOM Lagoon ユーザー</p>
<p>(Lagoon ユーザー)</p>
</td><td colspan="1" rowspan="1"><p>SORACOM Lagoon へログインするためのユーザー(IDとパスワードの組)</p>
<p>SORACOM ユーザコンソールへのログインとは異なるユーザ一覧となり、皆さん自身で登録・削除が可能です。ダッシュボードやパネルを編集できる「編集可能」と表示専用の「読み取り」の2段階の権限を設定できます。</p>
<p>作成可能数はプランによります。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>データリフレッシュ</p>
</td><td colspan="1" rowspan="1"><p>SORACOM Harvest から SORACOM Lagoon へデータが反映される事、もしくは反映タイミングとなります。反映タイミングはプランによります。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>アラート</p>
</td><td colspan="1" rowspan="1"><p>メトリクスのデータに対して条件を設定し、その条件を満たしたら通知を行う仕組みの事です。</p>
</td></tr>
</table>
<h2 is-upgraded><a href="https://console.soracom.io/" target="_blank">SORACOM ユーザーコンソール</a>の［Menu］&gt;［データ収集・蓄積・可視化］&gt;［SORACOM Lagoon］とクリックします。</h2>
<p class="image-container"><img style="width: 547.00px" src="img/df078d78ef3c64c9.png"></p>
<h2 is-upgraded>［SORACOM Lagoon の利用を開始する］をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/4a10b1d6ed1f5cc0.png"></p>
<h2 is-upgraded>プランのうち［Free］を選択したあと［続行する］をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/748cdbb71537788c.png"></p>
<h2 is-upgraded>SORACOM Lagoon ユーザーの初期ユーザーに設定するパスワードを入力した後、［利用開始］をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/f2b324c51b7a071e.png"></p>
<aside class="special"><p><strong>SORACOM Lagoon ユーザーの初期ユーザの ID は？</strong></p>
<p>ID は SORACOM ユーザコンソールにログインしたときのメールアドレスが使われることになります。そのため、ここではパスワードのみ設定することになります。<strong>SORACOM ユーザコンソールへのログインとは異なるパスワードを設定する事を強くお勧めします。</strong></p>
</aside>
<aside class="warning"><p><strong>利用開始がクリックできない場合は？</strong></p>
<p>パスワードの条件が不足しています。全てに✔がつくようにパスワードを設定してください。</p>
</aside>
<p>SORACOM Lagoon の有効化に成功すると、以下のように SORACOM Lagoon コンソールへのリンクと、Lagoon ユーザーの一覧が管理できるようになります。</p>
<p>この画面を SORACOM Lagoon 管理画面と呼びます。</p>
<p class="image-container"><img style="width: 602.00px" src="img/6c91011f8fa4eb2.png"></p>
<p>SORACOM Lagoon 管理画面は、SORACOM Lagoon が有効化されている間は ［Menu］&gt;［データ収集・蓄積・可視化］&gt;［SORACOM Lagoon］で表示する事ができます。</p>


      </google-codelab-step>
    
      <google-codelab-step label="SORACOM Lagoon でダッシュボードを作成する（パネル作成 ～ アラート設定）" duration="20">
        <h2 is-upgraded>SORACOM Lagoon 管理画面を表示したあと、［SORACOM Lagoon console にアクセス］をクリックします。</h2>
<p>※ SORACOM Lagoon 管理画面は ［Menu］&gt;［データ収集・蓄積・可視化］&gt;［SORACOM Lagoon］で表示する事ができます。</p>
<p class="image-container"><img style="width: 602.00px" src="img/e056d4558913af2.png"></p>
<h2 is-upgraded>SORACOM Lagoon へログインします。</h2>
<p>メールアドレス (SORACOM ユーザコンソールへログインする際のメールアドレス) と、SORACOM Lagoon 初期ユーザ作成時に利用したパスワードでログインします。</p>
<p class="image-container"><img style="width: 602.00px" src="img/d442ea101d6ae875.png"></p>
<p>ログインに成功すると、以下のような画面が表示されます。これが SORACOM Lagoon ログイン直後の画面です。ここから「ダッシュボード」や「パネル」を作成していきます。</p>
<p class="image-container"><img style="width: 602.00px" src="img/efbd59d7e7831f8f.png"></p>
<aside class="special"><p><strong>背景を白くしたい</strong></p>
<p>SORACOM Lagoon の標準では背景が黒となっています。これは設定で変更が可能です。</p>
<p>右下のアイコンにカーソルを合わせて表示される［設定］をクリックします。</p>
<p class="image-container"><img style="width: 342.00px" src="img/8cec8a9120d25dcd.png"></p>
<p>設定画面に &#34;テーマ&#34; を &#34;Light&#34; に変更して［保存］すると、背景が白くなります。</p>
<p class="image-container"><img style="width: 502.00px" src="img/69d5628454a7662a.png"></p>
</aside>
<h2 is-upgraded>アラート作成アイコン<img style="width: 42.00px" src="img/b32a9a5b5951b49c.png">にカーソルを乗せると表示される「作成」メニューから［通知チャンネル］をクリックし、その後表示される［チャンネルを追加］をクリックします。</h2>
<p class="image-container"><img style="width: 297.00px" src="img/af117aa0b9d789c5.png"></p>
<h2 is-upgraded><img style="width: 292.00px" src="img/99d2dc13bedafcf6.png"></h2>
<h2 is-upgraded>「新しい通知チャンネルを追加」では、以下のように設定します。</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>名前</p>
</td><td colspan="1" rowspan="1"><p><code>開閉の通知</code></p>
</td><td colspan="1" rowspan="1"><p>任意の名前が利用できます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>タイプ</p>
</td><td colspan="1" rowspan="1"><p>Email</p>
</td><td colspan="1" rowspan="1"><p>Email となっていれば次に進みます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Email addresses</p>
</td><td colspan="1" rowspan="1"><p>（通知の送信先 Email アドレス）</p>
</td><td colspan="1" rowspan="1"><p>通知の送信先アドレスを指定します。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 442.00px" src="img/f4087832a56a32fe.png"></p>
<p>ここまで入力が終わったら［送信テスト］をクリックします。「Email addresses」に記載したアドレスへ、以下のようなメールが届いていることを確認します。</p>
<p class="image-container"><img style="width: 602.00px" src="img/20ce666398a775bd.png"></p>
<p>テストの結果が良好であれば、SORACOM Lagoon の画面に戻り［保存］をクリックします。</p>
<p class="image-container"><img style="width: 442.00px" src="img/267a27e850b8af1c.png"></p>
<h2 is-upgraded>作成アイコン<img style="width: 40.00px" src="img/940a7161e06b7174.png">にカーソルを乗せると表示される「作成」メニューから［ダッシュボード］をクリックします。</h2>
<p class="image-container"><img style="width: 297.00px" src="img/3efe197697d950a1.png"></p>
<h2 is-upgraded>［Graph］ をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/c3360800d3def06.png"></p>
<aside class="special"><p>ダッシュボードが新規作成されると、最初のパネルも自動的にされます。パネルを追加したい場合は画面右上の<img style="width: 271.00px" src="img/ba6e7c6ec8c48277.png">で新たなパネルを追加できます。</p>
</aside>
<h2 is-upgraded>&#34;Panel Title&#34; &gt;［編集］をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/78d86dcd59a18a6e.png"></p>
<h2 is-upgraded>&#34;メトリック&#34; タブでノード(= SIM) をクリックし、SORACOM LTE-M Button Plus に紐づいている SIM を選びます。</h2>
<p>データソースは &#34;default&#34; に、メトリクスは &#34;Air&#34; になっているので、あとはノード(= SIM) を選びます。</p>
<p class="image-container"><img style="width: 602.00px" src="img/4bd385ee87e3f849.png"></p>
<p>選んだ時点で、全データが表示されます。</p>
<aside class="special"><p><strong>データが表示されていない？</strong></p>
<p>データを蓄積し始めてから間もない場合、グラフの右端に「少しだけ」表示されている場合があります。これは、パネルの表示時間の標準が「過去6時間分」を表示するようになっているからです。</p>
<p class="image-container"><img style="width: 602.00px" src="img/ba6f62b6a7245360.png"></p>
<p>右上の「時間」ボタンで表示範囲を設定可能です。まずは「過去15分間」くらいが良いでしょう。</p>
<p class="image-container"><img style="width: 587.00px" src="img/76a64d941a095f3.png"></p>
<p>また、グラフ作成直後のパネルは折れ線グラフ設定となっています。そのため、データを一件しか送っていない場合は「ポイント」としてのみ表示されているため、見落としがちです。何件か送るようにしてください。</p>
<p class="image-container"><img style="width: 559.00px" src="img/7444147bfe1fcff3.png"></p>
<p>それでもデータが表示されていない場合は、いったん SORACOM Harvest Data データの蓄積具合を確認するようにしてください。</p>
</aside>
<h2 is-upgraded>表示データを &#34;clickType&#34; のみにします。</h2>
<p>データの項目リストをクリックして &#34;clickType&#34; をクリックします。</p>
<p class="image-container"><img style="width: 602.00px" src="img/4dbf473279cf3fa4.png"></p>
<p>選ぶと、即時グラフに反映されます。</p>
<h2 is-upgraded>右上の保存ボタン<img style="width: 33.00px" src="img/6780dfe4cd33f2a0.png">をクリックし、表示されたダイアログでダッシュボード名を入力した上で［保存］をクリックします。</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>名前</p>
</td><td colspan="1" rowspan="1"><p><code>ドア開閉モニタリング</code></p>
</td><td colspan="1" rowspan="1"><p>任意の名前が利用できます。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 513.00px" src="img/5f445cbb2d4b679d.png"></p>
<h2 is-upgraded>ダッシュボードに戻るので、再度 &#34;Panel Title&#34; &gt;［編集］をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/78d86dcd59a18a6e.png"></p>
<h2 is-upgraded>&#34;アラート&#34; タブをクリックした後、［アラートの作成］をクリックします。</h2>
<p class="image-container"><img style="width: 602.00px" src="img/1dba07519807ce.png"></p>
<h2 is-upgraded>「アラート設定」を以下の通りに設定します。</h2>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>項目</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>設定値</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>備考</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>名前</p>
</td><td colspan="1" rowspan="1"><p><code>ドア開閉 Alert</code></p>
</td><td colspan="1" rowspan="1"><p>任意の名前が利用できます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>評価間隔</p>
</td><td colspan="1" rowspan="1"><p><code>60s</code></p>
</td><td colspan="1" rowspan="1"><p>閾値の監視間隔です。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>条件 (WHEN)</p>
</td><td colspan="1" rowspan="1"><p><code>last()</code></p>
</td><td colspan="1" rowspan="1"><p>&#34;avg()&#34; をクリックすると一覧に現れます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>条件 (OF)</p>
</td><td colspan="1" rowspan="1"><p><code>query(A, 90s, now)</code></p>
</td><td colspan="1" rowspan="1"><p>&#34;5m&#34; をクリックすると一覧が現れますが、<br>キーボードから &#34;<code>90s</code>&#34; と入力したあと<br>Enter キーを押して設定できます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>条件 (IS ABOVE)</p>
</td><td colspan="1" rowspan="1"><p><code>0</code></p>
</td><td colspan="1" rowspan="1"><p>&#34;IS ABOVE&#34; はそれ自体の条件の &#34;IS BELOW&#34;<br>(=以下)等に変更することができます。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>データが無いか全ての値が Null の時</p>
</td><td colspan="1" rowspan="1"><p><code>Ok</code></p>
</td><td colspan="1" rowspan="1"><p>評価間隔内でデータが無い、即ちボタンの動作が<br>無かった場合の扱いを設定しています。</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>実行エラーまたはタイムアウトの時</p>
</td><td colspan="1" rowspan="1"><p><code>Keep Last State</code></p>
</td><td colspan="1" rowspan="1"><p>何らかの理由で評価に失敗した時の設定です。<br>最後の状態を維持する設定としています。</p>
</td></tr>
</table>
<p class="image-container"><img style="width: 602.00px" src="img/1e36317541dbda47.png"></p>
<aside class="special"><p><strong>設定内容の意味は？</strong></p>
<ul>
<li><code>last()</code> は、条件(OF) で設定した期間内の最後(=最新)の値です。</li>
<li><code>query(A, 90s, now)</code> は、「メトリックの &#34;A&#34; を対象に、過去 90s から now までの間」となります。</li>
</ul>
<p>合わせると、メトリック &#34;A&#34; すなわち SORACOM LTE-M Button の ClickType を対象に、過去 <code>90s</code>(秒) から <code>now</code>(現在) における最後の値が <code>0</code> 以上（の時はアラート発生）という意味になります。</p>
</aside>
<p>ここまで入力が完了できたら［ルールを確認］をクリックします。この時点でボタンからのデータが過去90秒以内に発生していなければ  <code>firing: false</code> 即ち、アラートは発生せず、正常な設定となります。</p>
<p class="image-container"><img style="width: 268.00px" src="img/912d9bf6fb0c3838.png"></p>
<p>次に、ボタンを押してデータを発生させます。30秒～60秒経過した後に、再度［ルールを確認］をクリックすると <code>firing: true</code> 即ち、アラートが発生した状態となります。（この時点では通知の送信先を設定していないため、アラート発生の有無を確認するのみとなります。）</p>
<p class="image-container"><img style="width: 266.00px" src="img/47407b00b4337b96.png"></p>
<p>そこから30秒～60秒経過した後に、再度［ルールを確認］をクリックすると <code>firing: false</code> に戻ることが確認できるでしょう。</p>
<p>［ルールを確認］ボタンは何度でも押すことが可能ですので、何度か試してみることをお勧めいたします。</p>
<aside class="special"><p><strong>アラート発生のタイミングを調整するためには？</strong></p>
<p>評価間隔や条件の関係性は<a href="https://soracom.zendesk.com/hc/ja/articles/360028531812" target="_blank">SORACOM Lagoon のアラートがトリガーされないことがある</a>をご覧ください。</p>
</aside>
<h2 is-upgraded>［通知］をクリックした後、 &#34;送り先&#34; の追加 <img style="width: 40.00px" src="img/8366db64ed0d3c95.png"> をクリックします。一覧の中から通知チャンネルで作成した通知先をクリックします。</h2>
<p>本レシピでは &#34;開閉の通知&#34; という名称で作ったので、それをクリックします。</p>
<p class="image-container"><img style="width: 602.00px" src="img/2385aadad1fb385d.png"></p>
<h2 is-upgraded>&#34;メッセージ&#34; にアラート発生時のメッセージを入力します。</h2>
<p>ここでは扉が開いた時に反応するように SORACOM LTE-M Button Plus を構成しているため、その旨を入力しています。</p>
<p class="image-container"><img style="width: 408.00px" src="img/49047f42af8b745d.png"></p>
<h2 is-upgraded>右上の保存ボタン<img style="width: 33.00px" src="img/6780dfe4cd33f2a0.png">をクリックし、［保存］をクリックします。</h2>
<p>以上で全ての設定が終了しました。画面右上のダッシュボードに戻る<img style="width: 54.00px" src="img/2c69286f16fd7716.png">ボタンをクリックし、ダッシュボードに戻ります。</p>


      </google-codelab-step>
    
      <google-codelab-step label="アラートのメールを確認する" duration="10">
        <p>実際にドアを開閉して通知が来るか試してみましょう。以下のようなメールが届きます。</p>
<p class="image-container"><img style="width: 602.00px" src="img/e92559d26f4d4685.png"></p>
<p>また、最初の通知が届いてから約30～60秒で本文に「[OK]」が入ったメールが届きます。</p>
<p class="image-container"><img style="width: 602.00px" src="img/79e6335fe7701158.png"></p>
<p>これは &#34;データが無いか全ての値が Null の時&#34; で設定した &#34;Ok&#34; になります。ドアの開閉に伴った通知では無く「次回のアラート通知の準備が整った」状態という意味です。</p>
<p>このメールが来る前にドアの開閉が発生しても、新たな通知は来ないようになっています。これは、頻繁な通知による「通知爆弾」を避けるための仕組みです。</p>
<p>頻度を上げたい場合は、SORACOM Lagoon の有料プランをご検討ください。</p>


      </google-codelab-step>
    
      <google-codelab-step label="あとかたづけと注意事項" duration="1">
        <p>本レシピでは費用がかかるサービスを利用しています。<br>本項をよく読み、必要な操作や解除作業を行うようにして、想定外の費用が掛からないようにしてください。</p>
<h2 is-upgraded>費用について</h2>
<p>ここで記載している金額は全て税別、送料別となります。</p>
<h3 is-upgraded>SORACOM LTE-M Button</h3>
<p>ご利用にあたっては本体の価格とは別に、内蔵されている SIM (plan-KM1) の基本料金(月額100円)と、データ通信量に応じたデータ通信料※が発生します。<br>plan-KM1 の料金は<a href="https://soracom.jp/services/air/cellular/price_specific_area_sim/#plan-km1" target="_blank">ご利用料金 - 特定地域向け IoT SIM (plan-KM1)</a> をご確認ください。</p>
<p>※ 目安として、1送信あたり約 0.25 ~ 0.3 円程度</p>
<p>SORACOM Harvest Data を始めとした SORACOM プラットフォーム利用料は後述の通りかかります。</p>
<h3 is-upgraded>SORACOM プラットフォームの利用料金</h3>
<table>
<tr><td colspan="1" rowspan="1"><p><strong>サービス／機能</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>料金</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><a href="https://soracom.jp/services/harvest/price/" target="_blank">SORACOM Harvest Data</a></p>
</td><td colspan="1" rowspan="1"><p>本機能を有効にしたグループに所属する1SIMあたり5円/日 (2000リクエスト/日/SIMを含む)</p>
<p>2000リクエスト/日を超えた分は0.004円/リクエスト</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p><a href="https://soracom.jp/services/lagoon/" target="_blank">SORACOM Lagoon</a></p>
</td><td colspan="1" rowspan="1"><p>本レシピでは Free プラン(無料)を使用しました。その他の有料プランで出来るようになること等は <a href="https://soracom.jp/services/lagoon/price/" target="_blank">SORACOM Lagoon 利用料金のページ</a>をご覧ください。</p>
</td></tr>
</table>
<p>※ 費用詳細はリンク先をご確認ください。</p>
<aside class="special"><p><strong>無料利用枠について</strong></p>
<p>SORACOM サービスでは一部サービスにおいて無料枠が設定されています。たとえば SORACOM Air for セルラーであればアカウント毎で30円/月の通信分や、SORACOM Harvest Data であれば31日分の書込みリクエストなどです。料金詳細に「無料利用枠」として掲載されていますので、ご確認ください。</p>
</aside>
<h2 is-upgraded>グループ解除</h2>
<p>SORACOM Harvest Data 等、「機能が有効になっているグループに所属している SIM × 費用」となっているサービスにおいては、「機能を OFF にする」することで費用の発生を抑えることができます。またもう1つの方法として「グループに所属している SIM の数を減らす(= 解除する)」事でも費用を抑える事ができます。</p>
<p>グループ解除の方法は<a href="https://soracom.github.io/iot-recipes/unjoin-from-group/" target="_blank">グループからの解除 (JP)</a>をご覧ください。</p>
<h2 is-upgraded>SORACOM Harvest Data のデータ削除</h2>
<p>SORACOM Harvest Data は基本的にはデータ保管料は無料※です。そのため、保存しておいても害はありませんが、デモ等で利用する際にはデータを綺麗にしておく必要が出てくるため、データ削除について解説します。</p>
<p>※発生から40日を超えたデータは削除されます。40日以上データを保管したい場合は<a href="https://soracom.jp/services/harvest/price/" target="_blank">データ保持期間延長オプション利用料金</a>をご利用ください。</p>
<p>SORACOM Harvest Data 画面 (［操作］&gt;［データを確認］) のデータテーブルで、削除したいデータのチェックボックスを付けた後に［削除］をクリックします。表示されたダイアログで改めて［削除］をクリックすると、削除されます。<br>※ 複数のデータにチェックをつければ一括で削除可能です。</p>
<p class="image-container"><img style="width: 414.00px" src="img/637cac3bf206c47c.png"></p>
<p><strong>データの復元はできません</strong>のでご注意ください。</p>
<h2 is-upgraded>SORACOM Lagoon の解約</h2>
<p>SORACOM Lagoon はオンラインで解約が可能です。 Free プランであれば有効化しておいても費用は発生しませんが、長期に渡って利用しない場合には解約も選択いただけます。</p>
<p>解約の方法は<a href="https://soracom.github.io/iot-recipes/disable-soracom-lagoon" target="_blank">SORACOM Lagoon の解約(JP)</a>をご覧ください。</p>


      </google-codelab-step>
    
      <google-codelab-step label="次のステップ" duration="1">
        <p>本レシピでは、SORACOM LTE-M Button Plus と磁気センサーを利用したドアの開閉をセンシングしました。</p>
<p>磁気センサーはドアの開閉のみならず、幅広い活用方法が考えられます。</p>
<ul>
<li>トイレやお風呂等の生活で利用するドアに取り付けて、遠く離れた家族の見守り</li>
<li>ガレージや窓に取り付けて、家庭やオフィスの入退出記録</li>
<li>冷蔵庫やワインセラーに取り付けて、扉の閉め忘れ防止</li>
<li>キャビネットに取り付けて、重要書類へのアクセス記録</li>
<li>リモコン等「いつも元に戻しておいてもらいたいもの」に取り付けて、物品の取出し記録・戻し忘れ対策</li>
</ul>
<p>また、SORACOM LTE-M Button Plus の接点 I/F には、磁気センサー以外にも以下のようなセンサーを取り付けることが可能です。</p>
<ul>
<li>傾斜スイッチ</li>
<li>マイクロスイッチ</li>
<li>キーロックスイッチ</li>
</ul>
<p>接続の方法などは <a href="https://sorazine.soracom.jp/entry/2020/03/05/sensors-with-soracom-lte-m-button-plus" target="_blank">半田ごて不要！SORACOM LTE-M Button Plus とセンサーを繋げてみよう</a> をご覧ください。</p>
<p><a href="https://soracom.jp/products/kit/magnetic_sensor_kit/" target="_blank">商品ページへ戻る</a></p>
<h2 is-upgraded>活用事例集</h2>
<p>様々な活用事例がまとまっています</p>
<p><a href="https://sorazine.soracom.jp/entry/2019/04/17/button_usecases" target="_blank">最新LPWA通信規格 &#34;LTE-M&#34; 搭載ボタンで何つくる？〜次々に身近なユースケースが生まれる理由〜</a></p>
<h2 is-upgraded>外部のクラウドと連携する方法</h2>
<p>本レシピでは SORACOM Harvest Data や SORACOM Lagoon の連携までとなりましたが、他の SORACOM サービスの利用で AWS (Amazon Web Services) を始めとしたクラウドや SaaS との連携が可能となります。</p>
<p>具体的な方法は<a href="https://dev.soracom.io/jp/design_patterns/design_patterns_for_button/" target="_blank">SORACOM LTE-M Button を様々なクラウドや SaaS で活用するアーキテクチャー例</a>をご覧ください。</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://soracom.github.io/iot-recipes/codelab-elements/native-shim.js"></script>
  <script src="https://soracom.github.io/iot-recipes/codelab-elements/custom-elements.min.js"></script>
  <script src="https://soracom.github.io/iot-recipes/codelab-elements/prettify.js"></script>
  <script src="https://soracom.github.io/iot-recipes/codelab-elements/codelab-elements.js"></script>

</body>
</html>
